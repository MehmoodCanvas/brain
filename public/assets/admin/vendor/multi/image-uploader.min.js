/*! Image Uploader - v1.0.0 - 15/07/2019
 * Copyright (c) 2019 Christian Bayer; Licensed MIT */
!function(e){e.fn.imageUploader=function(t){let n={preloaded:[],imagesInputName:"images",preloadedInputName:"preloaded",label:"Drag & Drop files here or click to browse"},a=this;a.settings={},a.init=function(){a.settings=e.extend(a.settings,n,t),a.each(function(t,n){let i=d();if(e(n).append(i),i.on("dragover",l.bind(i)),i.on("dragleave",l.bind(i)),i.on("drop",p.bind(i)),a.settings.preloaded.length){i.addClass("has-files");let o=i.find(".uploaded");for(let r=0;r<a.settings.preloaded.length;r++)o.append(s(a.settings.preloaded[r].src,a.settings.preloaded[r].id,!0))}})};let i=new DataTransfer,d=function(){let t=e("<div>",{class:"image-uploader"}),n=e("<input>",{type:"file",id:a.settings.imagesInputName+"-"+c(),name:a.settings.imagesInputName+"[]",multiple:""}).appendTo(t),i=(e("<div>",{class:"uploaded"}).appendTo(t),e("<div>",{class:"upload-text"}).appendTo(t));return e("<i>",{class:"material-icons",text:"cloud_upload"}).appendTo(i),e("<span>",{text:a.settings.label}).appendTo(i),t.on("click",function(e){o(e),n.trigger("click")}),n.on("click",function(e){e.stopPropagation()}),n.on("change",p.bind(t)),t},o=function(e){e.preventDefault(),e.stopPropagation()},s=function(t,n){let d=e("<div>",{class:"uploaded-image"}),s=(e("<img>",{src:t}).appendTo(d),e("<button>",{class:"delete-image"}).appendTo(d));return e("<i>",{class:"material-icons",text:"clear"}).appendTo(s),a.settings.preloaded.length?(d.attr("data-preloaded",!0),e("<input>",{type:"hidden",name:a.settings.preloadedInputName+"[]",value:n}).appendTo(d)):d.attr("data-index",n),d.on("click",function(e){o(e)}),s.on("click",function(t){if(o(t),d.data("index")){let n=parseInt(d.data("index"));d.find(".uploaded-image[data-index]").each(function(t,a){t>n&&e(a).attr("data-index",t-1)}),i.items.remove(n);let a=i.files;($input=e('input[type="file"]')).prop("files",a)}d.remove(),d.find(".uploaded-image").length||d.removeClass("has-files")}),d},l=function(t){o(t),"dragover"===t.type?e(this).addClass("drag-over"):e(this).removeClass("drag-over")},p=function(t){o(t);let n=e(this);n.removeClass("drag-over");r(n,t.target.files||t.originalEvent.dataTransfer.files)},r=function(t,n){t.addClass("has-files");let a=t.find(".uploaded"),d=t.find('input[type="file"]');e(n).each(function(e,t){i.items.add(t),a.append(s(URL.createObjectURL(t),i.items.length-1))}),d.prop("files",i.files)},c=function(){return Date.now()+Math.floor(100*Math.random()+1)};return this.init(),this}}(jQuery),function(e){e.fn.imageUploader2=function(t){let n={preloaded:[],imagesInputName:"bigimage",preloadedInputName:"preloaded",label:"Drag & Drop files here or click to browse"},a=this;a.settings={},a.init=function(){a.settings=e.extend(a.settings,n,t),a.each(function(t,n){let i=d();if(e(n).append(i),i.on("dragover",l.bind(i)),i.on("dragleave",l.bind(i)),i.on("drop",p.bind(i)),a.settings.preloaded.length){i.addClass("has-files");let o=i.find(".uploaded");for(let r=0;r<a.settings.preloaded.length;r++)o.append(s(a.settings.preloaded[r].src,a.settings.preloaded[r].id,!0))}})};let i=new DataTransfer,d=function(){let t=e("<div>",{class:"image-uploader"}),n=e("<input>",{type:"file",id:a.settings.imagesInputName+"-"+c(),name:a.settings.imagesInputName+"[]",multiple:""}).appendTo(t),i=(e("<div>",{class:"uploaded"}).appendTo(t),e("<div>",{class:"upload-text"}).appendTo(t));return e("<i>",{class:"material-icons",text:"cloud_upload"}).appendTo(i),e("<span>",{text:a.settings.label}).appendTo(i),t.on("click",function(e){o(e),n.trigger("click")}),n.on("click",function(e){e.stopPropagation()}),n.on("change",p.bind(t)),t},o=function(e){e.preventDefault(),e.stopPropagation()},s=function(t,n){let d=e("<div>",{class:"uploaded-image"}),s=(e("<img>",{src:t}).appendTo(d),e("<button>",{class:"delete-image"}).appendTo(d));return e("<i>",{class:"material-icons",text:"clear"}).appendTo(s),a.settings.preloaded.length?(d.attr("data-preloaded",!0),e("<input>",{type:"hidden",name:a.settings.preloadedInputName+"[]",value:n}).appendTo(d)):d.attr("data-index",n),d.on("click",function(e){o(e)}),s.on("click",function(t){if(o(t),d.data("index")){let n=parseInt(d.data("index"));d.find(".uploaded-image[data-index]").each(function(t,a){t>n&&e(a).attr("data-index",t-1)}),i.items.remove(n);let a=i.files;($input=e('input[type="file"]')).prop("files",a)}d.remove(),d.find(".uploaded-image").length||d.removeClass("has-files")}),d},l=function(t){o(t),"dragover"===t.type?e(this).addClass("drag-over"):e(this).removeClass("drag-over")},p=function(t){o(t);let n=e(this);n.removeClass("drag-over");r(n,t.target.files||t.originalEvent.dataTransfer.files)},r=function(t,n){t.addClass("has-files");let a=t.find(".uploaded"),d=t.find('input[type="file"]');e(n).each(function(e,t){i.items.add(t),a.append(s(URL.createObjectURL(t),i.items.length-1))}),d.prop("files",i.files)},c=function(){return Date.now()+Math.floor(100*Math.random()+1)};return this.init(),this}}(jQuery);